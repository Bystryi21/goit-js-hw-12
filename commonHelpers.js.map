{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nexport const API_KEY = '44781462-ae4aaccc0a5ec19c0259ffb3b';\nconst api = 'https://pixabay.com/api/';\nconst imageType = 'photo';\nconst orientation = 'horizontal';\nconst safeSearch = true;\n\nexport async function fetchImages(q, page, perPage) {\n  const url = `${api}?key=${API_KEY}&q=${encodeURIComponent(\n    q\n  )}&image_type=${imageType}&orientation=${orientation}&safesearch=${safeSearch}&page=${page}&per_page=${perPage}`;\n\n  try {\n    const response = await axios.get(url);\n\n    if (response.status !== 200) {\n      throw new Error('Network response was not ok');\n    }\n\n    const { hits, totalHits } = response.data;\n\n    return { hits, totalHits };\n  } catch (error) {\n    console.error(error);\n    throw error;\n  }\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { fetchImages } from './js/pixabay-api.js';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst gallery = document.querySelector('.gallery');\nconst loadMoreBtn = document.querySelector('[data-action=\"load-more\"]');\nconst spinner = document.querySelector('.spinner');\nconst searchForm = document.querySelector('.search-form');\n\nconst hiddenClass = 'is-hidden';\nlet q = '';\nlet page = 1;\nlet perPage = 15;\nlet maxPage = 0;\n\nfunction hide(button) {\n  button.classList.add(hiddenClass);\n}\n\nfunction show(button) {\n  button.classList.remove(hiddenClass);\n}\n\nfunction disable(button, spinner) {\n  button.disabled = true;\n  spinner.classList.remove(hiddenClass);\n}\n\nfunction enable(button, spinner) {\n  button.disabled = false;\n  spinner.classList.add(hiddenClass);\n}\n\nhide(loadMoreBtn);\n\nsearchForm.addEventListener('submit', handleSearch);\n\nasync function handleSearch(event) {\n  event.preventDefault();\n\n  gallery.innerHTML = '';\n  page = 1;\n\n  const form = event.currentTarget;\n  q = form.elements.search.value.trim();\n\n  if (!q) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Search field cannot be empty!',\n    });\n    return;\n  }\n\n  show(loadMoreBtn);\n  disable(loadMoreBtn, spinner);\n\n  try {\n    const { hits, totalHits } = await fetchImages(q, page, perPage);\n\n    maxPage = Math.ceil(totalHits / perPage);\n    appendImagesMarkup(hits);\n\n    if (hits.length > 0 && hits.length !== totalHits) {\n      enable(loadMoreBtn, spinner);\n      loadMoreBtn.addEventListener('click', handleLoadMore);\n    } else {\n      hide(loadMoreBtn);\n    }\n  } catch (error) {\n    console.error(error);\n    iziToast.error({\n      title: 'Error',\n      message: 'Failed to fetch images. Please try again later.',\n    });\n  } finally {\n    form.reset();\n  }\n}\n\nasync function handleLoadMore() {\n  page += 1;\n  disable(loadMoreBtn, spinner);\n\n  try {\n    const { hits } = await fetchImages(q, page, perPage);\n    appendImagesMarkup(hits);\n  } catch (error) {\n    console.error(error);\n    iziToast.error({\n      title: 'Error',\n      message: 'Failed to fetch more images. Please try again later.',\n    });\n  } finally {\n    enable(loadMoreBtn, spinner);\n\n    if (page === maxPage) {\n      hide(loadMoreBtn);\n      loadMoreBtn.removeEventListener('click', handleLoadMore);\n    }\n  }\n}\n\nfunction appendImagesMarkup(images) {\n  const markup = images\n    .map(\n      image => `<li>\n        <a href=\"${image.largeImageURL}\" data-lightbox=\"gallery\" data-title=\"${image.tags}\">\n          <img src=\"${image.webformatURL}\" alt=\"${image.tags}\" />\n          <div class=\"info\">\n            <p><strong>Likes:</strong> ${image.likes}</p>\n            <p><strong>Views:</strong> ${image.views}</p>\n            <p><strong>Comments:</strong> ${image.comments}</p>\n            <p><strong>Downloads:</strong> ${image.downloads}</p>\n          </div>\n        </a>\n      </li>`\n    )\n    .join('');\n\n  gallery.insertAdjacentHTML('beforeend', markup);\n}\n\nlet lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n"],"names":["API_KEY","api","imageType","orientation","safeSearch","fetchImages","q","page","perPage","url","response","axios","hits","totalHits","error","gallery","loadMoreBtn","spinner","searchForm","hiddenClass","maxPage","hide","button","show","disable","enable","handleSearch","event","form","iziToast","appendImagesMarkup","handleLoadMore","images","markup","image","SimpleLightbox"],"mappings":"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"}